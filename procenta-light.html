<!doctype html>
<html lang="cs">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Procenta ‚Äì tr√©nink</title>
<meta name="theme-color" content="#0b1323" />
<style>
  :root{
    --bg:#0b1323; --panel:#0f1729; --text:#e6eef8; --muted:#9fb0c7; --accent:#60a5fa;
    --ok:#22c55e; --wrong:#ef4444; --card:#101826;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:linear-gradient(180deg,var(--bg),#0d1528);color:var(--text);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  .app{max-width:min(900px,96vw);margin:24px auto; padding:16px}
  header{display:flex;align-items:center;gap:12px;justify-content:space-between;margin-bottom:16px}
  .hearts{position:fixed;top:10px;right:12px;display:flex;gap:6px;z-index:10}
  .heart{width:20px;height:20px;display:grid;place-items:center;filter:drop-shadow(0 0 6px #f87171)}
  .heart::before{content:"‚ù§";font-size:18px}
  .devils{position:fixed;top:36px;right:12px;display:flex;gap:6px;z-index:10}
  .devil{width:20px;height:20px;display:grid;place-items:center;filter:drop-shadow(0 0 6px #a855f7)}
  .devil::before{content:"üòà";font-size:18px}
  .panel{background:var(--panel);border:1px solid #1b2946;border-radius:18px;padding:16px}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .tag{padding:4px 10px;border:1px solid #233152;border-radius:999px;color:var(--muted);font-size:12px}
  .big{font-size:20px}
  .btn{appearance:none;border:1px solid #25324f;background:#15203a;color:var(--text);padding:10px 14px;border-radius:12px;cursor:pointer}
  .btn:hover{background:#182444}
  .btn.primary{border-color:#245bb5;background:#1b3b70}
  .qcard{background:var(--card);border:1px solid #1a2744;border-radius:16px;padding:14px}
  .qtitle{color:var(--muted);font-size:13px;margin-bottom:6px}
  .qtext{font-size:22px; line-height:1.3}
  .opts{display:grid;gap:10px;margin-top:12px}
  .opt{border:1px solid #273454;background:#141d34;border-radius:12px;padding:10px 12px;cursor:pointer;text-align:left}
  .opt:hover{background:#18223c}
  .opt.correct{outline:2px solid var(--ok)}
  .opt.wrong{outline:2px solid var(--wrong)}
  .status{margin-top:8px;font-size:14px;color:var(--muted)}
  .footer{display:flex;gap:10px;justify-content:flex-end;margin-top:14px}
  .sep{height:1px;background:#1b2946;margin:14px 0}
  *{color:#ffffff!important}
</style>
</head>
<body>
<div class="hearts" id="hearts"></div>
<div class="devils" id="devils"></div>

<div class="app">
  <header>
    <div class="row">
      <div class="tag">Kolo: <span id="roundNo">1</span></div>
      <div class="tag">Ot√°zka v kole: <span id="inRound">1</span>/<span id="perRound">3</span></div>
      <div class="tag">Bezchybnƒõ toto kolo: <span id="streak">0</span>/<span id="perRound2">3</span></div>
    </div>
    <div class="row">
      <button class="btn" id="btnReset">Reset</button>
      <button class="btn primary" id="btnNext" disabled>Dal≈°√≠</button>
    </div>
  </header>

  <section class="panel">
    <div class="row" style="justify-content:space-between">
      <div class="big" id="catName">‚Äî</div>
      <div class="tag">Zb√Ωv√° v kategorii: <span id="leftInCat">‚Äî</span></div>
    </div>
    <div class="sep"></div>

    <div id="card" class="qcard">
      <div class="qtitle" id="qTitle">P≈ô√≠klad</div>
      <div class="qtext" id="qText">‚Äî</div>
      <div class="opts" id="options"></div>
      <div class="status" id="status"></div>
    </div>

    <div class="footer">
      <button class="btn" id="btnNewRound" disabled>Dal≈°√≠ kolo</button>
    </div>
  </section>

  <p class="status">
    Tr√©nink procent: 3 kategorie √ó 10 √∫loh. V ka≈æd√©m kole 1 √∫loha z ka≈æd√© kategorie (max. 10 kol).  
    Kolo bez chyby p≈ôid√° ‚ù§, ka≈æd√° chyba p≈ôid√° üòà. √ölohy se neopakuj√≠.
  </p>
</div>

<script>
/* ---------- √öLOHY ---------- */
function Q(text, correct){return {text, correct};}
const CATS=[
  {name:"1) V√Ωpoƒçet z√°kladu",items:[]},
  {name:"2) V√Ωpoƒçet procentov√© ƒç√°sti",items:[]},
  {name:"3) V√Ωpoƒçet poƒçtu procent",items:[]}
];

// 1Ô∏è‚É£ V√Ωpoƒçet z√°kladu
for(let i=1;i<=10;i++){
  const p = [10,12,15,20,25,30,40,50,60,75][i-1];
  const cast = Math.floor(Math.random()*400+50);
  const zaklad = +(cast / (p/100)).toFixed(1);
  const text=`${p}% z nezn√°m√©ho z√°kladu je ${cast}. Urƒçi z√°klad.`;
  const correct=`${zaklad}`;
  const opts=[zaklad, zaklad+10, zaklad-10, zaklad+20].sort(()=>Math.random()-0.5);
  CATS[0].items.push({text,correct,opts});
}

// 2Ô∏è‚É£ V√Ωpoƒçet procentov√© ƒç√°sti
for(let i=1;i<=10;i++){
  const p = [5,8,10,12,15,20,25,30,40,60][i-1];
  const zaklad = Math.floor(Math.random()*400+100);
  const cast = +(zaklad * (p/100)).toFixed(1);
  const text=`Urƒçi ${p}% z ${zaklad}.`;
  const correct=`${cast}`;
  const opts=[cast, cast+5, cast-5, cast+10].sort(()=>Math.random()-0.5);
  CATS[1].items.push({text,correct,opts});
}

// 3Ô∏è‚É£ V√Ωpoƒçet poƒçtu procent
for(let i=1;i<=10;i++){
  const zaklad = Math.floor(Math.random()*300+100);
  const cast = Math.floor(zaklad*(Math.random()*0.8+0.1));
  const p = +(100*cast/zaklad).toFixed(1);
  const text=`Kolik procent je ${cast} z ${zaklad}?`;
  const correct=`${p}`;
  const opts=[p,p+2,p-2,p+5].sort(()=>Math.random()-0.5);
  CATS[2].items.push({text,correct,opts});
}

/* ---------- STAV ---------- */
let round=1,inRound=0,roundCorrect=0;
const used=CATS.map(()=>new Set());
let current=null;

/* ---------- ODKAZY NA HTML ---------- */
const elCatName=document.getElementById('catName');
const elLeftInCat=document.getElementById('leftInCat');
const elQTitle=document.getElementById('qTitle');
const elQText=document.getElementById('qText');
const elOptions=document.getElementById('options');
const elStatus=document.getElementById('status');
const elRoundNo=document.getElementById('roundNo');
const elInRound=document.getElementById('inRound');
const elStreak=document.getElementById('streak');
const elPerRound=document.getElementById('perRound');
const elPerRound2=document.getElementById('perRound2');
const elBtnNext=document.getElementById('btnNext');
const elBtnNewRound=document.getElementById('btnNewRound');
const elBtnReset=document.getElementById('btnReset');
const elHearts=document.getElementById('hearts');
const elDevils=document.getElementById('devils');

const QUESTIONS_PER_ROUND=CATS.length;
elPerRound.textContent=QUESTIONS_PER_ROUND;
elPerRound2.textContent=QUESTIONS_PER_ROUND;

/* ---------- FUNKCE ---------- */
function pickFromCategory(catIdx){
  const cat=CATS[catIdx];
  const available=[];
  for(let i=0;i<cat.items.length;i++) if(!used[catIdx].has(i)) available.push(i);
  if(available.length===0)return null;
  const qIndex=available[Math.floor(Math.random()*available.length)];
  return{catIdx,qIndex};
}

function startNextQuestion(){
  elStatus.textContent=''; elOptions.innerHTML=''; elBtnNext.disabled=true;
  if(inRound>=QUESTIONS_PER_ROUND){
    if(roundCorrect===QUESTIONS_PER_ROUND){
      const h=document.createElement('div'); h.className='heart'; elHearts.appendChild(h);
      elStatus.innerHTML=`Kolo ${round} hotovo bez chyby ‚ù§`;
    }else{
      elStatus.innerHTML=`Kolo ${round} hotovo. Spr√°vnƒõ ${roundCorrect}/${QUESTIONS_PER_ROUND}.`;
    }
    elBtnNewRound.disabled=false; return;
  }
  const catIdx=inRound;
  const picked=pickFromCategory(catIdx);
  if(!picked){
    elCatName.textContent=CATS[catIdx].name;
    elLeftInCat.textContent='0';
    elQTitle.textContent='V t√©to kategorii do≈°ly √∫lohy.';
    elQText.textContent='Zkus dal≈°√≠ kolo nebo Reset.';
    elBtnNewRound.disabled=false;
    return;
  }
  const cat=CATS[catIdx];
  const q=cat.items[picked.qIndex];
  used[catIdx].add(picked.qIndex);
  current={catIndex:catIdx,qIndex:picked.qIndex,correct:q.correct};

  elCatName.textContent=cat.name;
  elLeftInCat.textContent=String(cat.items.length-used[catIdx].size);
  elQTitle.textContent=`√öloha #${picked.qIndex+1}`;
  elQText.textContent=q.text;

  q.opts.forEach((val)=>{
    const b=document.createElement('button');
    b.className='opt';
    b.textContent=val;
    b.addEventListener('click',()=>{
      if(b.dataset.locked==='1')return;
      [...elOptions.children].forEach(x=>x.dataset.locked='1');
      if(String(val)===String(current.correct)){
        b.classList.add('correct'); elStatus.textContent='Spr√°vnƒõ!'; roundCorrect++;
      }else{
        b.classList.add('wrong'); elStatus.textContent='≈†patnƒõ.';
        [...elOptions.children].forEach(x=>{if(x.textContent===String(current.correct))x.classList.add('correct');});
        const d=document.createElement('div'); d.className='devil'; elDevils.appendChild(d);
      }
      elBtnNext.disabled=false;
    });
    elOptions.appendChild(b);
  });
  inRound++; elInRound.textContent=inRound; elStreak.textContent=roundCorrect;
}

function newRound(){round++;inRound=0;roundCorrect=0;elRoundNo.textContent=round;elInRound.textContent='0';elStreak.textContent='0';elBtnNewRound.disabled=true;startNextQuestion();}
function resetAll(){round=1;inRound=0;roundCorrect=0;used.forEach(s=>s.clear());elHearts.innerHTML='';elDevils.innerHTML='';elRoundNo.textContent='1';elInRound.textContent='0';elStreak.textContent='0';elBtnNewRound.disabled=true;startNextQuestion();}

/* ---------- OVL√ÅD√ÅN√ç ---------- */
elBtnNext.addEventListener('click',startNextQuestion);
elBtnNewRound.addEventListener('click',newRound);
elBtnReset.addEventListener('click',resetAll);

/* ---------- START ---------- */
startNextQuestion();
</script>
</body>
</html>
